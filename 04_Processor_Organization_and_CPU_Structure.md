# 04. Processor Organization and CPU Structure

---

## What is Processor Organization?

Processor organization defines how the Central Processing Unit (CPU) is structured, how it interacts with other system components, and how instructions are fetched, decoded, and executed.

---

## CPU Components

- **Arithmetic Logic Unit (ALU):** Performs arithmetic and logical operations.
- **Control Unit (CU):** Directs operations by generating control signals.
- **Registers:** Fast storage inside the CPU for operands, instructions, and addresses.
- **Program Counter (PC):** Holds the address of the next instruction to execute.
- **Instruction Register (IR):** Holds the currently executing instruction.
- **Stack Pointer (SP):** Points to the top of the stack (for stack-based operations).
- **Status/Flag Registers:** Indicate conditions (zero, overflow, carry, etc.).

---

## CPU Datapath

- **Datapath:** The collection of registers, ALU, and buses that data flows through inside the CPU.
- **Buses:** Internal pathways that transfer data between components (data, address, control buses).
- **Multiplexers/Demultiplexers:** Used to select data sources/destinations.

---

## Control Unit (CU)

- **Hardwired Control:** Control signals generated by fixed logic.
- **Microprogrammed Control:** Uses a control memory to store microinstructions.

---

## Instruction Execution Cycle

1. **Fetch:** Get instruction from memory.
2. **Decode:** Interpret the instruction.
3. **Execute:** Perform the operation (ALU, memory, I/O).
4. **Memory Access:** Read/write operands if needed.
5. **Write Back:** Store the result.

---

## Register Organization

- **General Purpose Registers (GPRs):** Used for operands, temporary storage (e.g., AX, BX, CX in x86).
- **Special Purpose Registers:** PC, IR, SP, flag registers.
- **Register File:** Group of registers accessed via addressing.

---

## Stack Organization

- **Stack:** LIFO data structure, used for expression evaluation, subroutine calls, interrupt handling.
- **Stack Pointer (SP):** Register holding the top address of the stack.
- **Push/Pop Operations:** Add/remove items on the stack.

---

## Bus Organization

- **Single Bus:** All components share one data path; simple but can be a bottleneck.
- **Multiple Bus:** Separate buses for data, address, and control; allows more parallelism.

---

## Data Path Design

- **Single-cycle Datapath:** All steps in one clock cycle (simple CPUs).
- **Multi-cycle Datapath:** Each step in a separate clock cycle (complex CPUs, pipelining).

---

## Micro-operations

- Basic operations on CPU registers (e.g., loading, incrementing, shifting).
- Micro-operations form the basis of instruction execution.

---

## Example: Simple CPU Organization

```
            +-----------------------------+
            |          CPU                |
            | +-------+   +-----------+   |
  Bus <---->| | Regs  |---|   ALU     |---|-----> Bus
            | +-------+   +-----------+   |
            |     |           |           |
            |     +-----+-----+           |
            |           |                 |
            |       Control Unit          |
            +-----------------------------+
```

---

## Harvard vs. Von Neumann in CPU

- **Von Neumann:** Single shared memory, one bus for instructions and data.
- **Harvard:** Separate memory and buses for instructions and data (faster, less bottleneck).

---

## Interrupts

- Allow CPU to stop current execution and service external/internal events.
- **Interrupt Service Routine (ISR):** Special routine executed on interrupt.

---

## Direct Memory Access (DMA)

- Allows peripherals to access memory directly, reducing CPU overhead.

---

## Interview Patterns

- Draw the CPU datapath and label components.
- Explain the instruction execution cycle.
- Describe the role and types of registers.
- Compare stack-based and register-based organization.
- Discuss the difference between hardwired and microprogrammed control.

---

## Common Pitfalls

- Ignoring the difference between register types.
- Overlooking the importance of the control unit.
- Confusing instruction execution stages.

---

## Exercises

1. Draw the block diagram of a typical CPU and label all parts.
2. Explain how an interrupt is handled by the CPU.
3. Compare the advantages/disadvantages of hardwired and microprogrammed control.
4. What is the role of the stack pointer in subroutine calls?
5. Explain the importance of the program counter.

---

## Key Interview Questions

- What is the function of the ALU in the CPU?
- Describe the instruction cycle in detail.
- Why are registers faster than main memory?
- How does the control unit coordinate CPU operations?
- What is the difference between a register file and RAM?

---

## References

- [Stallings, Computer Organization and Architecture, Ch. 6](https://www.pearson.com/en-us/subject-catalog/p/computer-organization-and-architecture/P200000001275/9780134101613)
- [Patterson & Hennessy, Computer Organization and Design, Ch. 4](https://www.elsevier.com/books/computer-organization-and-design-arm-edition/patterson/978-0-12-801733-3)
- [GeeksforGeeks - CPU Organization](https://www.geeksforgeeks.org/cpu-organization/)
- [Wikipedia: Central Processing Unit](https://en.wikipedia.org/wiki/Central_processing_unit)

---
